
all_R_scripts.R 


plot_conservation_enrichment_BD_2015.R 
setwd(dir="/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners")
library("car")

data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_100_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_100Homologs = data$domain_conservation_over_100Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_100Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))

data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_200_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_200Homologs = data$domain_conservation_over_200Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_200Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))

data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_300_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_300Homologs = data$domain_conservation_over_300Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_300Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))

data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_400_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_400Homologs = data$domain_conservation_over_400Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_400Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))

data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_500_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_500Homologs = data$domain_conservation_over_500Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_500Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))


data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_600_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_600Homologs = data$domain_conservation_over_600Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_600Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))

data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_700_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_700Homologs = data$domain_conservation_over_700Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_700Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))

data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_800_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_800Homologs = data$domain_conservation_over_800Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_800Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))


data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_900_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_900Homologs = data$domain_conservation_over_900Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_900Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))


data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_1000_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_1000Homologs = data$domain_conservation_over_1000Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_1000Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))


data<-read.csv("/Users/verstrat/temp_qb/paper_elm_2014/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_10000_Zscores_color.txt", sep="	", header=T)
#domain_name = data$domain_name
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_10000Homologs = data$domain_conservation_over_10000Homologs
z_score_enrichment = data$color
print(z_score_enrichment)
#this gives a cool picture of a scatterplot with plotboxes
#plot(domain_representation ~ domain_conservation, data, xlab="domain_conservation, %", ylab="domain_representation, log(obs/exp)", main="Predicted Pfam features in ank proteins", col=z_score_enrichment)
scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_10000Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1))
 

plot_enrichment_BD_by_clan_2015.R 
setwd(dir="/Users/nina/Dropbox/Draft_nina/domains/Pfam_local_search/binding_partners")
library("car")

par(mar=c(5,5,3,2))

data<-read.csv("/Users/nina/Dropbox/Draft_nina/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_1000_Zscores_color_with_clans_binding_MAPPED_ordered_by_clans.txt", sep="	", header=T)

domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
z_score_enrichment = data$Zscores_enrichment
plot(domain_enrichment_log.obs.exp, col=ifelse(z_score_enrichment<1,'black','red'),pch=19, cex = .5, main = "Domains in Ankyrin Interacting partners", xlab = "Pfam Domains", xaxt='n', ylab = "Pfam Domain enrichment, log(obs/exp)")


data<-read.csv("/Users/nina/Dropbox/Draft_nina/domains/Pfam_local_search/binding_partners/Pfam_domains_in_binding_partners_2038.fasta_MaxHomologs_1000_Zscores_color.txt", sep="	", header=T)
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_1000Homologs = data$domain_conservation_over_1000Homologs
z_score_enrichment = data$color
dev.off()

scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_1000Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1), legend.plot=FALSE, main = "Domains in Ankyrin Interacting partners", ylab = "Pfam Domain enrichment, log(obs/exp)")

plot_enrichment_ankyrin_by_clan_2015.R 
setwd(dir="/Users/nina/Dropbox/Draft_nina/domains/Pfam_local_search")
library("car")

par(mar=c(5,5,3,2))

data<-read.csv("/Users/nina/Dropbox/Draft_nina/domains/Pfam_local_search/Pfam_domains_in_all-ank-20130926.fasta_MaxHomologs_1000_Zscores_color_with_clans_binding_MAPPED_ordered_by_clans.txt", sep="	", header=T)

domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
z_score_enrichment = data$Zscores_enrichment
plot(domain_enrichment_log.obs.exp, col=ifelse(z_score_enrichment<1,'black','red'),pch=19, cex = .5, main = "Domains in Ankyrin proteins", xlab = "Pfam Domains", xaxt='n', ylab = "Pfam Domain enrichment, log(obs/exp)")


data<-read.csv("/Users/nina/Dropbox/Draft_nina/domains/Pfam_local_search/Pfam_domains_in_all-ank-20130926.fasta_MaxHomologs_1000_Zscores_color.txt", sep="	", header=T)
domain_enrichment_log.obs.exp = data$domain_enrichment_log.obs.exp.
domain_conservation_over_1000Homologs = data$domain_conservation_over_1000Homologs
z_score_enrichment = data$color
dev.off()

scatterplot(domain_enrichment_log.obs.exp~domain_conservation_over_1000Homologs,groups=z_score_enrichment,by.groups=F, smoother=FALSE, reg.line=FALSE, grid = FALSE, xlim=c(0,1), legend.plot=FALSE, main = "Domains in Ankyrin proteins", ylab = "Pfam Domain enrichment, log(obs/exp)")

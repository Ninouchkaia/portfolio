from .io import read_tsv, write_lines\n\nMODEL_TF = ['STAT1','STAT5A','STAT5B','NFKB1','NFKB2','PPARG','STAT6','STAT3','IRF3','IRF5','IRF4','KLF4','HIF1A']\n\ndef compute_signatures(input_file, output_file):\n    rows = read_tsv(input_file)\n    M1, M2, NLC = [], [], []\n    output_lines = []\n    for row in rows:\n        TF = row[0]\n        m1 = float(row[2]); m2 = float(row[3]); nlc = float(row[4])\n        if nlc > m1 and nlc > m2:\n            NLC.append(TF); output_lines.append(f"{TF}\t{m1}\t{m2}\t{nlc}")\n        elif m1 > nlc and m1 > m2:\n            M1.append(TF)\n        elif m2 > m1 and m2 > nlc:\n            M2.append(TF)\n    write_lines(output_file, output_lines)\n    return {'M1_signature': set(M1),'M2_signature': set(M2),'NLC_signature': set(NLC)}

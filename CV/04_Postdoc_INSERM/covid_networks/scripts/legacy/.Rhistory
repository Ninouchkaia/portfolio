ck_df <- as.data.frame(ck, stringsAsFactors=FALSE)
library(readr)
# write_tsv(ck_df, "enrichPathway-2ndorder-pvalueCutoff0.005.tsv")
write_tsv(ck_df, "enrichGOBP-2ndorder-pvalueCutoff0.005.tsv")
# extract the data from the compareResult function and make a matrix to draw a heatmap
descriptionList <- unique(ck_df$Description)
clusterList <- unique(ck_df$Cluster)
myClusterMap <- matrix(0,nrow=length(descriptionList),ncol = length(clusterList))
rownames(myClusterMap)<-descriptionList
colnames(myClusterMap) <- clusterList
for ( i in 1:nrow(ck_df)) {
print(i)
description <- ck_df$Description[i]
print(description)
cluster <- ck_df$Cluster[i]
print(cluster)
myClusterMap[rownames(myClusterMap) == description, colnames(myClusterMap) == cluster] <- 1  ## trop fort Miguel (problem with the dots in the column names)
}
library(pheatmap)
my_clusters <- pheatmap(myClusterMap)
pheatmap(myClusterMap, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete")
## pval 0.005
# ck <- compareCluster(geneCluster = dfNinaMapped, fun = "enrichGO", OrgDb='org.Hs.eg.db', pvalueCutoff = 0.005, ont="BP")
ck <- compareCluster(geneCluster = dfNinaMapped, fun = "enrichGO", OrgDb='org.Hs.eg.db', pvalueCutoff = 0.005, ont="MF")
dotplot(ck, font.size=3)#, split = TRUE) #,showCategory = 50)
# transform the result as a dataframe
ck_df <- as.data.frame(ck, stringsAsFactors=FALSE)
# write_tsv(ck_df, "enrichPathway-2ndorder-pvalueCutoff0.005.tsv")
# write_tsv(ck_df, "enrichGOBP-2ndorder-pvalueCutoff0.005.tsv")
write_tsv(ck_df, "enrichGOMF-2ndorder-pvalueCutoff0.005.tsv")
# extract the data from the compareResult function and make a matrix to draw a heatmap
descriptionList <- unique(ck_df$Description)
clusterList <- unique(ck_df$Cluster)
myClusterMap <- matrix(0,nrow=length(descriptionList),ncol = length(clusterList))
rownames(myClusterMap)<-descriptionList
colnames(myClusterMap) <- clusterList
for ( i in 1:nrow(ck_df)) {
print(i)
description <- ck_df$Description[i]
print(description)
cluster <- ck_df$Cluster[i]
print(cluster)
myClusterMap[rownames(myClusterMap) == description, colnames(myClusterMap) == cluster] <- 1  ## trop fort Miguel (problem with the dots in the column names)
}
pheatmap(myClusterMap, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete")
# fetch the gene lists from file
# gcSampleNinaRaw <- read.table("genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
# gcSampleNinaRaw <- read.table("first_and_second_order_genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("first_and_second_order_genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
gcSampleNina <- read.table("first_and_secondThird_order_genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("first_and_second_and_third_order_genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
# fetch the gene lists from file
# gcSampleNinaRaw <- read.table("genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
# gcSampleNinaRaw <- read.table("first_and_second_order_genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("first_and_second_order_genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
gcSampleNina <- read.table("first_and_secondThird_order_genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("first_and_second_and_third_order_genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
# fetch the gene lists from file
# gcSampleNinaRaw <- read.table("genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
# gcSampleNinaRaw <- read.table("first_and_second_order_genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("first_and_second_order_genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
gcSampleNina <- read.table("first_and_second_and_thir_order_genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("first_and_second_and_thir_order_genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
# fetch the gene lists from file
# gcSampleNinaRaw <- read.table("genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
# gcSampleNinaRaw <- read.table("first_and_second_order_genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("first_and_second_order_genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
gcSampleNina <- read.table("first_and_second_and_third_order_genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("first_and_second_and_third_order_genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
virus_names_mapping <- read.table("virus-host_PPI_info_nina.txt", header = FALSE, sep = '\t')
short_names = virus_names_mapping$V2
names(short_names) = virus_names_mapping$V1
# print(short_names["Chikungunya virus (strain S27-African prototype)"])
View(short_names)
# create a function that converts long names into short names
virus_name_mapping_function <- function(virus_name){short_names[virus_name]}
# map the long names to short names
gcSampleNina <- gcSampleNinaRaw
gcSampleNina$V1 <- sapply(gcSampleNinaRaw$V1, virus_name_mapping_function) #better to use sapply instead of lapply because we're working with a single column ie a vector
View(gcSampleNina$V1)
#transpose
dfNina <- data.frame(t(gcSampleNina[-1]))
colnames(dfNina) <- gcSampleNina[, 1]
# fetch mapping entrez - gene symbols (it will take the first mappings if there are synonyms) # check the mappings !!!
mart_export_mappings <- read.table("mart_export.txt", "\t", header=TRUE, stringsAsFactors=FALSE)
#remove NA from the mapping file
# mart_export_mappings_curated <- mart_export_mappings[!is.na(mart_export_mappings$NCBI.gene..formerly.Entrezgene..ID),]
mart_export_mappings_curated <- mart_export_mappings[!is.na(mart_export_mappings$NCBI.gene..formerly.Entrezgene..ID),]
# make a dict of the mapping file
entrez_names = mart_export_mappings_curated$NCBI.gene..formerly.Entrezgene..ID
names(entrez_names) = mart_export_mappings_curated$Gene.name # check !
print(entrez_names["PRKACA"])
# create a function that converts gene symbols into entrez ids
my_function <- function(gene_name){entrez_names[gene_name]}
# map our gene symbols in our dataframe to entrez ids
dfNinaMapped <- as.data.frame(lapply(dfNina, my_function))
# run enrichment analysis and compare clusters together with clusterProfiler and function compareCluster
library(clusterProfiler)
# BiocManager::install("ReactomePA")
# BiocManager::install("reactome.db")
library("ReactomePA")
library("reactome.db")
## pval 0.005
# ck <- compareCluster(geneCluster = dfNinaMapped, fun = "enrichGO", OrgDb='org.Hs.eg.db', pvalueCutoff = 0.005, ont="BP")
# ck <- compareCluster(geneCluster = dfNinaMapped, fun = "enrichGO", OrgDb='org.Hs.eg.db', pvalueCutoff = 0.005, ont="MF")
ck <- compareCluster(geneCluster = dfNinaMapped, fun = "enrichPathway", pvalueCutoff=0.005)
dotplot(ck, font.size=3)#, split = TRUE) #,showCategory = 50)
?dotplot
dotplot(ck, font.size=3) +
theme(axis.text.x = element_text(angle = 90))#, split = TRUE) #,showCategory = 50)
dotplot(ck, font.size=3, las=2) +
#theme(axis.text.x = element_text(angle = 90))#, split = TRUE) #,showCategory = 50)
?dotplot
dotplot(ck, font.size=3, las=2) +
#theme(axis.text.x = element_text(angle = 90))#, split = TRUE) #,showCategory = 50)
#?dotplot
# transform the result as a dataframe
ck_df <- as.data.frame(ck, stringsAsFactors=FALSE)
dotplot(ck, font.size=3, las=2) +
#theme(axis.text.x = element_text(angle = 90))#, split = TRUE) #,showCategory = 50)
?dotplot
dotplot(ck, font.size=3, label_format = 1)# +
dotplot(ck, font.size=3, label_format = 30)# +
dotplot(ck, font.size=3, label_format = 30)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))
dotplot(ck, font.size=3)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
dotplot(ck, font.size=3)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))
# transform the result as a dataframe
ck_df <- as.data.frame(ck, stringsAsFactors=FALSE)
library(readr)
write_tsv(ck_df, "enrichPathway-3rdorder-pvalueCutoff0.005.tsv")
# extract the data from the compareResult function and make a matrix to draw a heatmap
descriptionList <- unique(ck_df$Description)
clusterList <- unique(ck_df$Cluster)
myClusterMap <- matrix(0,nrow=length(descriptionList),ncol = length(clusterList))
rownames(myClusterMap)<-descriptionList
colnames(myClusterMap) <- clusterList
for ( i in 1:nrow(ck_df)) {
print(i)
description <- ck_df$Description[i]
print(description)
cluster <- ck_df$Cluster[i]
print(cluster)
myClusterMap[rownames(myClusterMap) == description, colnames(myClusterMap) == cluster] <- 1  ## trop fort Miguel (problem with the dots in the column names)
}
library(pheatmap)
pheatmap(myClusterMap, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete")
# make a list out of all the viruses and genes that are viral interactors
myGeneVirusTable <- read.table("virus_gene_table_third_order.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
# make empty matrix of size of genes_list
myGenesMatrix <- matrix(0,nrow=length(myGenesList), ncol = length(myVirusList))
rownames(myGenesMatrix)<- myGenesList
colnames(myGenesMatrix) <- myVirusList
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
View(ck_df)
View(myGenesMatrix)
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
# make a list out of all the viruses and genes that are viral interactors
myGeneVirusTable <- read.table("virus_gene_table_second_order.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
View(myGeneVirusTable)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
View(myGenesList)
# make empty matrix of size of genes_list
myGenesMatrix <- matrix(0,nrow=length(myGenesList), ncol = length(myVirusList))
rownames(myGenesMatrix)<- myGenesList
colnames(myGenesMatrix) <- myVirusList
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
library(viridis)
?pheatmap
pheatmap(myGenesMatrix, fontsize_row = 1, clustering_distance_cols = "binary", clustering_method = "complete", color="viridis")
install.packages("viridis")
install.packages("viridis")
library(viridis)
install.packages("viridis")
install.packages("viridis")
install.packages("viridis")
install.packages("viridis")
library(viridis)
pheatmap(myGenesMatrix, fontsize_row = 1, clustering_distance_cols = "binary", clustering_method = "complete", color="viridis")
# make a list out of all the viruses and genes that are viral interactors
myGeneVirusTable <- read.table("virus_gene_table_second_order.txt", header=FALSE, sep="\t")
# make a list out of all the viruses and genes that are viral interactors
myGeneVirusTable <- read.table("virus_gene_table.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
View(myGeneVirusTable)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
View(myGenesList)
# make empty matrix of size of genes_list
myGenesMatrix <- matrix(0,nrow=length(myGenesList), ncol = length(myVirusList))
rownames(myGenesMatrix)<- myGenesList
colnames(myGenesMatrix) <- myVirusList
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
install.packages("viridis")
install.packages("viridis")
library(viridis)
pheatmap(myGenesMatrix, fontsize_row = 1, clustering_distance_cols = "binary", clustering_method = "complete", color="viridis")
library(pheatmap)
pheatmap(myGenesMatrix, fontsize_row = 1, clustering_distance_cols = "binary", clustering_method = "complete", color="viridis")
?pheatmap
pheatmap(myGenesMatrix, fontsize_row = 1, clustering_distance_cols = "binary", clustering_method = "complete", color.palette=viridis)
?pheatmap
pheatmap(myGenesMatrix, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color.palette=viridis)
pheatmap(myGenesMatrix, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=Viridis)
pheatmap(myGenesMatrix, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=inferno(10))
pheatmap(myGenesMatrix, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(10))
pheatmap(myGenesMatrix, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis())
pheatmap(myGenesMatrix, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
# make a list out of all the viruses and genes that are viral interactors
myGeneVirusTable <- read.table("virus_gene_table.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
View(myGeneVirusTable)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
View(myGenesList)
virus_names_mapping <- read.table("virus-host_PPI_info_nina.txt", header = FALSE, sep = '\t')
short_names = virus_names_mapping$V2
names(short_names) = virus_names_mapping$V1
# print(short_names["Chikungunya virus (strain S27-African prototype)"])
View(short_names)
# create a function that converts long names into short names
virus_name_mapping_function <- function(virus_name){short_names[virus_name]}
# make a list out of all the viruses and genes that are viral interactors
myGeneVirusTable <- read.table("virus_gene_table.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
View(myGeneVirusTable)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
View(myGenesList)
# make empty matrix of size of genes_list
myGenesMatrix <- matrix(0,nrow=length(myGenesList), ncol = length(myVirusList))
rownames(myGenesMatrix)<- myGenesList
colnames(myGenesMatrix) <- myVirusList
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
library(viridis)
pheatmap(myGenesMatrix, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
# make a list out of all the viruses and genes that are viral interactors
myGeneVirusTable <- read.table("virus_gene_table_second_order.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
View(myGeneVirusTable)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
View(myGenesList)
# make empty matrix of size of genes_list
myGenesMatrix <- matrix(0,nrow=length(myGenesList), ncol = length(myVirusList))
rownames(myGenesMatrix)<- myGenesList
colnames(myGenesMatrix) <- myVirusList
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
pheatmap(myGenesMatrix, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, treeheight_row = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, treeheight_row = 500, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, treeheight_row = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
# make a list out of all the viruses and genes that are viral interactors
myGeneVirusTable <- read.table("virus_gene_table.txt", header=FALSE, sep="\t")
# myGeneVirusTable <- read.table("virus_gene_table_second_order.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
# make empty matrix of size of genes_list
myGenesMatrix <- matrix(0,nrow=length(myGenesList), ncol = length(myVirusList))
rownames(myGenesMatrix)<- myGenesList
colnames(myGenesMatrix) <- myVirusList
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
library(viridis)
pheatmap(myGenesMatrix, fontsize_row = 1, treeheight_row = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
?pheatmap
pheatmap(myGenesMatrix, fontsize_row = 1, treeheight_col = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, treeheight_col = 200, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, treeheight_col = 300, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, fonsize_col = 2, treeheight_col = 250, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, fonsize_col = 2, treeheight_col = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
# make a list out of all the viruses and genes that are viral interactors
# myGeneVirusTable <- read.table("virus_gene_table.txt", header=FALSE, sep="\t")
myGeneVirusTable <- read.table("virus_gene_table_second_order.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
# make empty matrix of size of genes_list
myGenesMatrix <- matrix(0,nrow=length(myGenesList), ncol = length(myVirusList))
rownames(myGenesMatrix)<- myGenesList
colnames(myGenesMatrix) <- myVirusList
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
pheatmap(myGenesMatrix, fontsize_row = 1, fonsize_col = 2, treeheight_col = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
# make a list out of all the viruses and genes that are viral interactors
# myGeneVirusTable <- read.table("virus_gene_table.txt", header=FALSE, sep="\t")
myGeneVirusTable <- read.table("virus_gene_table_second_third_order.txt", header=FALSE, sep="\t")
# make a list out of all the viruses and genes that are viral interactors
# myGeneVirusTable <- read.table("virus_gene_table.txt", header=FALSE, sep="\t")
myGeneVirusTable <- read.table("virus_gene_table_third_order.txt", header=FALSE, sep="\t")
myGeneVirusTable$V1 <- sapply(myGeneVirusTable$V1, virus_name_mapping_function)
myVirusList <- unique(myGeneVirusTable$V1)
myGenesList <- unique(myGeneVirusTable$V2)
# make empty matrix of size of genes_list
myGenesMatrix <- matrix(0,nrow=length(myGenesList), ncol = length(myVirusList))
rownames(myGenesMatrix)<- myGenesList
colnames(myGenesMatrix) <- myVirusList
# fill it with 1 if gene is among viral interactors of specific virus
for ( i in 1:nrow(myGeneVirusTable)) {
gene <- myGeneVirusTable$V2[i]
virus <- myGeneVirusTable$V1[i]
myGenesMatrix[rownames(myGenesMatrix) == gene, colnames(myGenesMatrix) == virus] <- 1
}
pheatmap(myGenesMatrix, fontsize_row = 1, fonsize_col = 2, treeheight_col = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, fonsize_col = 2, treeheight_col = 400, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, fonsize_col = 2, treeheight_col = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
pheatmap(myGenesMatrix, fontsize_row = 1, fonsize_col = 2, treeheight_col = 100, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
# fetch the gene lists from file
gcSampleNinaRaw <- read.table("genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
View(gcSampleNinaRaw)
virus_names_mapping <- read.table("virus-host_PPI_info_nina.txt", header = FALSE, sep = '\t')
short_names = virus_names_mapping$V2
names(short_names) = virus_names_mapping$V1
# create a function that converts long names into short names
virus_name_mapping_function <- function(virus_name){short_names[virus_name]}
# map the long names to short names
gcSampleNina <- gcSampleNinaRaw
gcSampleNina$V1 <- sapply(gcSampleNinaRaw$V1, virus_name_mapping_function) #better to use sapply instead of lapply because we're working with a single column ie a vector
#transpose
dfNina <- data.frame(t(gcSampleNina[-1]))
colnames(dfNina) <- gcSampleNina[, 1]
sum <- sapply(dfNina, function(x) sum(x!=''))
sum_values <- data.frame(sum)
barplot(sum_values$sum, main='number of human protein interactors', xlab = names(sum_values))
# par(mar=c(2, 15, 3, 10)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=2, cex.names=0.5 )
sum_values$virus <- rownames(sum_values)
# par(mar=c(2, 15, 3, 10)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=2, cex.names=0.5 )
par(mar=c(2, 15, 3, 10)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=2, cex.names=0.5 )
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=1, font.lab=2, cex.names=0.5 )
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=1, font.lab=1, cex.names=0.5 )
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=1, font.lab=1, cex.names=0.5 )
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=1, font.lab=1, cex.names=0.1
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=1, font.lab=1, cex.names=0.4
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=0.5, font.lab=1, cex.names=0.4
)
1
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=1, font.lab=1, cex.names=0.4
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=1, cex.names=0.4
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=5, font.lab=1, cex.names=0.4
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=10, font.lab=1, cex.names=0.4
)
par(mar=c(2, 2, 3, 2)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=10, font.lab=1, cex.names=0.4
)
par(mar=c(2, 15, 3, 2)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=10, font.lab=1, cex.names=0.4
)
par(mar=c(0, 15, 3, 2)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=10, font.lab=1, cex.names=0.4
)
par(mar=c(2, 15, 3, 0)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=10, font.lab=1, cex.names=0.4
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=1, cex.names=0.4
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=5, cex.names=0.4
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=5, cex.names=0.4
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=1, cex.names=1
)
par(mar=c(2, 15, 3, 10)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=1, cex.names=1
)
0.4
par(mar=c(2, 15, 3, 10)) # 15 line height for bottom margin
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=1, cex.names=1
)
barplot(sum_values$sum, main='number of human protein interactors', names = sum_values$virus, horiz=T , las=1, font.axis=2, font.lab=1, cex.names=0.5
)
# fetch the gene lists from file
gcSampleNinaRaw <- read.table("genes_list.txt", header = FALSE, sep = "\t", col.names = paste0("V",seq_len(max(count.fields("genes_list.txt", sep = '\t')))),, dec = ".", fill = TRUE, stringsAsFactors=FALSE)
virus_names_mapping <- read.table("virus-host_PPI_info_nina.txt", header = FALSE, sep = '\t')
short_names = virus_names_mapping$V2
names(short_names) = virus_names_mapping$V1
# create a function that converts long names into short names
virus_name_mapping_function <- function(virus_name){short_names[virus_name]}
# map the long names to short names
gcSampleNina <- gcSampleNinaRaw
gcSampleNina$V1 <- sapply(gcSampleNinaRaw$V1, virus_name_mapping_function) #better to use sapply instead of lapply because we're working with a single column ie a vector
#transpose
dfNina <- data.frame(t(gcSampleNina[-1]))
colnames(dfNina) <- gcSampleNina[, 1]
# fetch mapping entrez - gene symbols (it will take the first mappings if there are synonyms) # check the mappings !!!
mart_export_mappings <- read.table("mart_export.txt", "\t", header=TRUE, stringsAsFactors=FALSE)
#remove NA from the mapping file
# mart_export_mappings_curated <- mart_export_mappings[!is.na(mart_export_mappings$NCBI.gene..formerly.Entrezgene..ID),]
mart_export_mappings_curated <- mart_export_mappings[!is.na(mart_export_mappings$NCBI.gene..formerly.Entrezgene..ID),]
# make a dict of the mapping file
entrez_names = mart_export_mappings_curated$NCBI.gene..formerly.Entrezgene..ID
names(entrez_names) = mart_export_mappings_curated$Gene.name # check !
# create a function that converts gene symbols into entrez ids
my_function <- function(gene_name){entrez_names[gene_name]}
# map our gene symbols in our dataframe to entrez ids
dfNinaMapped <- as.data.frame(lapply(dfNina, my_function))
# run enrichment analysis and compare clusters together with clusterProfiler and function compareCluster
library(clusterProfiler)
ck <- compareCluster(geneCluster = dfNinaMapped, fun = "enrichPathway", pvalueCutoff=0.05)
# BiocManager::install("ReactomePA")
# BiocManager::install("reactome.db")
library("ReactomePA")
library("reactome.db")
ck <- compareCluster(geneCluster = dfNinaMapped, fun = "enrichPathway", pvalueCutoff=0.05)
library(ggplot2)
dotplot(ck, font.size=3)+ theme(axis.text.x = element_text(angle = 45, hjust = 1))
# transform the result as a dataframe
ck_df <- as.data.frame(ck, stringsAsFactors=FALSE)
library(readr)
write_tsv(ck_df, "enrichPathway-1storder-pvalueCutoff0.05.tsv")
# extract the data from the compareResult function and make a matrix to draw a heatmap
descriptionList <- unique(ck_df$Description)
clusterList <- unique(ck_df$Cluster)
myClusterMap <- matrix(0,nrow=length(descriptionList),ncol = length(clusterList))
rownames(myClusterMap)<-descriptionList
colnames(myClusterMap) <- clusterList
for ( i in 1:nrow(ck_df)) {
print(i)
description <- ck_df$Description[i]
print(description)
cluster <- ck_df$Cluster[i]
print(cluster)
myClusterMap[rownames(myClusterMap) == description, colnames(myClusterMap) == cluster] <- 1  ## trop fort Miguel (problem with the dots in the column names)
}
library(pheatmap)
library(viridis)
pheatmap(myClusterMap, fontsize_row = 1, cluster_rows = FALSE, clustering_distance_cols = "binary", clustering_method = "complete", color=viridis(100))
View(dfNinaMapped)
View(dfNinaMapped)
View(dfNinaMapped)
library(stats)
a <- phyper(3, 247, 18423, 4, lower.tail = TRUE, log.p = FALSE)
a <- phyper(4, 247, 18423, 4, lower.tail = TRUE, log.p = FALSE)
?phyper
a <- phyper(4, 247, 18423, 4, lower.tail = TRUE)
?pheatmap
#install.packages("tidyverse")
library(tidyverse)
optimized_parameters <- read.csv("A:/Downloads/Projects/workFromHome/Projects/ABM-openmole/NGSA/calib_ABMPhago.txt", header=F, sep=",")
View(optimized_parameters)
optimized_parameters2 = data.frame(subset(optimized_parameters, select=c("V2", "V3")))
myplot <- ggplot(optimized_parameters2, aes(x = V2, y = V3)) +
geom_point()
myplot + geom_density_2d_filled(alpha = 0.5)
myplot + geom_density_2d_filled(alpha = 0.5) +
geom_density_2d(size = 0.25, colour = "black")
myplot + stat_density_2d(
geom = "raster",
aes(fill = after_stat(density)),
contour = FALSE
) + scale_fill_viridis_c() +labs(y= "NLC-phago-eff", x = "mono-phago-eff")
#install.packages("tidyverse")
library(tidyverse)
optimized_parameters <- read.csv("A:/Downloads/Projects/workFromHome/Projects/ABM-openmole/NGSA/calib_ABMPhago.txt", header=F, sep=",")
View(optimized_parameters)
optimized_parameters <- read.csv("A:/Downloads/Projects/workFromHome/Projects/ABM-openmole/NGSA/calib_ABMPhago2.txt", header=F, sep=",")
View(optimized_parameters)
optimized_parameters2 = data.frame(subset(optimized_parameters, select=c("V2", "V3")))
myplot <- ggplot(optimized_parameters2, aes(x = V2, y = V3)) +
geom_point()
myplot + geom_density_2d_filled(alpha = 0.5)
myplot + geom_density_2d_filled(alpha = 0.5) +
geom_density_2d(size = 0.25, colour = "black")
myplot + stat_density_2d(
geom = "raster",
aes(fill = after_stat(density)),
contour = FALSE
) + scale_fill_viridis_c() +labs(y= "NLC-phago-eff", x = "mono-phago-eff")
installed.packages()

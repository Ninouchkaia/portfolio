source("./deconvolution_algorithms.R")
install.packages('MCPcounter')
install.packages(c("devtools","curl")) ##Installs devtools and the MCPcounter dependancy 'curl'
install_github("ebecht/MCPcounter",ref="master", subdir="Source")
install.packages(c("devtools","curl"))
library(devtools)
install_github("ebecht/MCPcounter",ref="master", subdir="Source")
source("./deconvolution_algorithms.R")
install.packages("remotes")
remotes::install_github("icbi-lab/immunedeconv")
library(devtools)
install_github("ebecht/MCPcounter",ref="master", subdir="Source")
remotes::install_github("grst/immunedeconv")
source("./deconvolution_algorithms.R")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DeconRNASeq")
source("./deconvolution_algorithms.R")
rnaseq_tpm <- read.delim("./rnaseq_tpm_ed.txt", header = T, row.names = 1)
rnaseq_tpm_deconvolutions <- deconvolutions(rnaseq_tpm)
install.packages('stringi')
install.packages("stringi")
rnaseq_tpm_deconvolutions <- deconvolutions(rnaseq_tpm)
source("./deconvolution_algorithms.R")
rnaseq_tpm <- read.delim("./rnaseq_tpm_ed.txt", header = T, row.names = 1)
rnaseq_tpm_deconvolutions <- deconvolutions(rnaseq_tpm)
View(rnaseq_tpm_deconvolutions)
View(rnaseq_tpm_deconvolutions)
colnames(rnaseq_tpm_deconvolutions)
Epidish_BPRNA <-rnaseq_tpm_deconvolutions[,89:98]
View(Epidish_BPRNA)
View(Epidish_BPRNA)
remove(Epidish_BPRNA)
Epidish_BPRNACan <- rnaseq_tpm_deconvolutions[,89:98]
DeconRNASeq_BPRNACan <- rnaseq_tpm_deconvolutions[,99:108]
Epidish_BPRNACan3DProMet <- rnaseq_tpm_deconvolutions[,109:118]
DeconRNASeq_BPRNACan3DProMet <- rnaseq_tpm_deconvolutions[,119:128]
Epidish_BPRNACanProMet <- rnaseq_tpm_deconvolutions[,129:138]
DeconRNASeq_BPRNACanProMet <- rnaseq_tpm_deconvolutions[,139:148]
View(Epidish_BPRNACanProMet)
strsplit(colnames(Epidish_BPRNACan)[1], [[,)
strsplit(colnames(Epidish_BPRNACan)[1], '[[',)
strsplit(colnames(Epidish_BPRNACan)[1], "_")
strsplit(colnames(Epidish_BPRNACan)[1], "_")[3]
strsplit(colnames(Epidish_BPRNACan), "_")
sapply(strsplit(colnames(Epidish_BPRNACan), "_"), "]]", 1)
sapply(strsplit(colnames(Epidish_BPRNACan), "_"), "]]", 3)
sapply(strsplit(colnames(Epidish_BPRNACan), "_"), "]]", 2)
sapply(strsplit(colnames(Epidish_BPRNACan), "_"), "[[", 1)
sapply(strsplit(colnames(Epidish_BPRNACan), "_"), "[[", 2)
sapply(strsplit(colnames(Epidish_BPRNACan), "_"), "[[", 3)
name(Epidish_BPRNACan)
sapply(strsplit(colnames(Epidish_BPRNACan), "_"), "[[", 3)
new_colnames = sapply(strsplit(colnames(Epidish_BPRNACan), "_"), "[[", 3)
colnames(Epidish_BPRNACan) = new_colnames
View(Epidish_BPRNACan)
write.table(Fres, './output/Epidish_BPRNACan_dcv.txt',
sep = "\t", quote = F, row.names = F, col.names = T)
write.table(Epidish_BPRNACan, './output/Epidish_BPRNACan_dcv.txt',
sep = "\t", quote = F, row.names = F, col.names = T)
extract_dcv_pancaldi <- function(rnaseq_tpm_deconvolutions, col_i = 89, col_f = 98, file_name){
subset_df = rnaseq_tpm_deconvolutions[,col_i:col_f]
new_colnames = sapply(strsplit(colnames(subset_df), "_"), "[[", 3)
colnames(subset_df) = new_colnames
write.table(subset_df, file.path('./output/',file_name),
sep = "\t", quote = F, row.names = F, col.names = T)
}
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, col_i = 89, col_f = 98, file_name = 'Epidish_BPRNACan_dcv.txt')
grep('Epidish_BPRNACan_',colnames(rnaseq_tpm_deconvolutions))
file.path('./output/', paste0('Epidish_BPRNACan', '_dcv.txt')
)
file.path('.','output', paste0('Epidish_BPRNACan', '_dcv.txt'))
write.table(subset_df, file.path('.','output', paste0(method_signature_name, '_dcv.txt')),
sep = "\t", quote = F, row.names = F, col.names = T)
extract_dcv_pancaldi <- function(rnaseq_tpm_deconvolutions, method_signature_name){
subset_df = rnaseq_tpm_deconvolutions[,grep(method_signature_name, colnames(rnaseq_tpm_deconvolutions))]
new_colnames = sapply(strsplit(colnames(subset_df), "_"), "[[", 3)
colnames(subset_df) = new_colnames
write.table(subset_df, file.path('.','output', paste0(method_signature_name, '_dcv.txt')),
sep = "\t", quote = F, row.names = F, col.names = T)
}
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'Epidish_BPRNACan')
```{r}
extract_dcv_pancaldi <- function(rnaseq_tpm_deconvolutions, method_signature_name){
subset_df = rnaseq_tpm_deconvolutions[,grep(method_signature_name, colnames(rnaseq_tpm_deconvolutions))]
new_colnames = sapply(strsplit(colnames(subset_df), "_"), "[[", 3)
colnames(subset_df) = new_colnames
write.table(subset_df, file.path('.','output', paste0(method_signature_name, 'dcv.txt')),
sep = "\t", quote = F, row.names = F, col.names = T)
}
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'Epidish_BPRNACan_')
extract_dcv_pancaldi <- function(rnaseq_tpm_deconvolutions, method_signature_name){
subset_df = rnaseq_tpm_deconvolutions[,grep(method_signature_name, colnames(rnaseq_tpm_deconvolutions))]
new_colnames = sapply(strsplit(colnames(subset_df), "_"), "[[", 3)
colnames(subset_df) = new_colnames
write.table(subset_df, file.path('.','output', paste0(method_signature_name, 'dcv.txt')),
sep = "\t", quote = F, row.names = F, col.names = T)
}
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'Epidish_BPRNACan_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'DeconRNASeq_BPRNACan_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'Epidish_BPRNACan3DProMet_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'DeconRNASeq_BPRNACan3DProMet_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'Epidish_BPRNACanProMet_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'DeconRNASeq_BPRNACanProMet_')
extract_dcv_pancaldi <- function(rnaseq_tpm_deconvolutions, method_signature_name){
subset_df = rnaseq_tpm_deconvolutions[,grep(method_signature_name, colnames(rnaseq_tpm_deconvolutions))]
new_colnames = sapply(strsplit(colnames(subset_df), "_"), "[[", 3)
colnames(subset_df) = new_colnames
subset_df <- cbind(Sample = rownames(subset_df), subset_df)
write.table(subset_df, file.path('.','output', paste0(method_signature_name, 'dcv.txt')),
sep = "\t", quote = F, row.names = F, col.names = T)
}
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'Epidish_BPRNACan_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'DeconRNASeq_BPRNACan_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'Epidish_BPRNACan3DProMet_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'DeconRNASeq_BPRNACan3DProMet_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'Epidish_BPRNACanProMet_')
extract_dcv_pancaldi(rnaseq_tpm_deconvolutions, method_signature_name = 'DeconRNASeq_BPRNACanProMet_')
file.path(main_path,"Epidish_BPRNACan_dcv.txt")
main_path = '/Users/senosam/Documents/Massion_lab/RNASeq_summary/deconvolution/output/rna_only/Pancaldi'
file.path(main_path,"Epidish_BPRNACan_dcv.txt")
test = <- read.delim(file.path(main_path,"Epidish_BPRNACan_dcv.txt"), row.names=1)
test <- read.delim(file.path(main_path,"Epidish_BPRNACan_dcv.txt"), row.names=1)
View(test)
cbs_dcv <- read.delim("~/Documents/Massion_lab/RNASeq_summary/deconvolution/output/rna_only/CBS/CIBERSORT.rna_only_fpkm.txt", row.names=1)
View(cbs_dcv)
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
source('/Users/senosam/Documents/Repositories/Research/data_analysis_rnaseq/R/30_DEGanalysis.R')
source("/Users/senosam/Documents/Repositories/Research/data_analysis_cytof/R/51_supervised_analysis_viz.R")
source("/Users/senosam/Documents/Repositories/Research/data_analysis_cytof/R/20_ClustAnnot_functions.R")
load("/Users/senosam/Documents/Massion_lab/RNASeq_summary/rnaseq.RData")
environment_set()
ls_preprocessed <- preprocess_rna(path_rnaseq = '/Users/senosam/Documents/Massion_lab/RNASeq_summary/rnaseq.RData',
correct_batch = F, lowvargenesrm = T, prot_coding_only = F, xychr_rm = T)
CDE <- read.csv(file = '/Users/senosam/Documents/Massion_lab/CyTOF_summary/CDE_TMA36_2021JAN13_SA_MF.csv')
pData_rnaseq <- CDE[match(ls_preprocessed$pData_rnaseq$pt_ID, CDE$pt_ID),]
ls_preprocessed$pData_rnaseq <- pData_rnaseq
# adding FPKM
rownames(fpkm_all) <- fpkm_all$Feature
fpkm_all <- fpkm_all[match(ls_preprocessed$rna_all$Feature, rownames(fpkm_all)),]
fpkm_all <- fpkm_all[,ls_preprocessed$p_all$Vantage_ID]
ls_preprocessed$fpkm_all <- as.matrix(fpkm_all)
# adding TPM
rownames(tpm_all) <- rna_all$Feature
tpm_all <- tpm_all[match(ls_preprocessed$rna_all$Feature, rownames(tpm_all)),]
tpm_all <- tpm_all[,ls_preprocessed$p_all$Vantage_ID]
ls_preprocessed$tpm_all <- tpm_all
print(ls_preprocessed$pbatch_bf)
#print(ls_preprocessed$pbatch_af)
DE_res <- DE_analysis(ls_preprocessed,
GeneBased=FALSE,
pDataBased=TRUE,
NewCondition=FALSE,
cond_nm='n_op2',
two_levels=c('agg','ind'),
reference = 'ind')
heatmap_200(DE_res$res_df, DE_res$vsd_mat_sym, DE_res$meta_data, DE_res$pData_rnaseq, scale_mat = T)
volcano_plot(DE_res$res_df, gene=NULL, p_title='Indolent vs Aggressive')
l2fc_cutoff=1.5
pval_cutoff = 0.05
res_df <- data.frame(DE_res$res_df) %>%
na.omit() %>%
filter(abs(log2FoldChange) > l2fc_cutoff) %>%
filter(pvalue < pval_cutoff) %>%
arrange(pvalue)
rownames(res_df) <- NULL
knitr::kable(res_df)
fgsea_res <- fgsea_analysis(DE_res)
fgsea_plot(fgsea_res$res_hm, pathways_title='Hallmark', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_c1, pathways_title='C1 positional genes', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_c2, pathways_title='C2 curated genes', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_c3, pathways_title='C3 regulatory target genes', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_c4, pathways_title='C4 cancer', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_c5, pathways_title='C5 GO genes', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_c6, pathways_title='C6 oncogenic', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_c7, pathways_title='C7 immunologic', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_msg, pathways_title='All signatures', condition_name='Indolent vs Aggressive')
fgsea_plot(fgsea_res$res_rtm, pathways_title='REACTOME', condition_name='Indolent vs Aggressive')
keggres <- kegg_go(DE_res, kegg = T, GO = F)
keggGO_plot(keggres, pathways_title='KEGG', cutoff = 0.05,
max_pathways = 10, condition_name='Indolent vs Aggressive', pval_colnm='p.val')
keggres <- kegg_go(DE_res, kegg = F, GO = T)
keggGO_plot(keggres, pathways_title='GO', cutoff = 0.05,
max_pathways = 10, condition_name='Indolent vs Aggressive', pval_colnm='p.val')
hla_i <- grep('^HLA', ls_preprocessed$rna_all$Feature_gene_name)
hla_ids <- as.character(ls_preprocessed$rna_all$Feature[hla_i])
hla_gsym <- as.character(ls_preprocessed$rna_all$Feature_gene_name[hla_i])
# Filter MHC-II related genes from DE genes
de_hla <- data.frame(DE_res$res)[hla_ids,] %>%
mutate(gene=hla_gsym) %>%
arrange(desc(abs(log2FoldChange))) %>%
slice(which(pvalue<0.05))
hm_genes <- function(ls_preprocessed, mat_name, hla_ids, hla_gsym, scale_mat = TRUE){
int_idx <- which(ls_preprocessed$pData_rnaseq$n_op2 == 'int')
mat <- as.matrix(ls_preprocessed[[mat_name]])
mat <- mat[,-int_idx]
mat <- mat[hla_ids,]
ha = HeatmapAnnotation(
Condition = as.factor(ls_preprocessed$pData_rnaseq$n_op2[-int_idx]),
SILA = ls_preprocessed$pData_rnaseq$SILA[-int_idx],
Stage = ls_preprocessed$pData_rnaseq$Stages_simplified[-int_idx],
simple_anno_size = unit(0.5, "cm")
)
if(scale_mat){
mat <- t(scale(t(mat)))
}
rownames(mat) <- hla_gsym
Heatmap(mat, name = "mat",
column_split = as.factor(ls_preprocessed$pData_rnaseq$n_op2[-int_idx]),
heatmap_legend_param = list(color_bar = "continuous"),
row_names_gp = gpar(fontsize = 8),
column_names_gp = gpar(fontsize = 8), top_annotation = ha)
}
hm_genes(ls_preprocessed, 'vsd_mat', hla_ids, hla_gsym, scale_mat = T)
hm_genes(ls_preprocessed, 'vsd_mat', rownames(de_hla), de_hla$gene, scale_mat = T)
hm_genes(ls_preprocessed, 'tpm_all', hla_ids, hla_gsym, scale_mat = T)
hm_genes(ls_preprocessed, 'tpm_all', rownames(de_hla), de_hla$gene, scale_mat = T)
hm_genes(ls_preprocessed, 'fpkm_all', hla_ids, hla_gsym, scale_mat = T)
hm_genes(ls_preprocessed, 'fpkm_all', rownames(de_hla), de_hla$gene, scale_mat = T)
pca_hla <- function(ls_preprocessed, mat_name, hla_ids, scale_mat = TRUE){
int_idx <- which(ls_preprocessed$pData_rnaseq$n_op2 == 'int')
mat <- data.frame(t(ls_preprocessed[[mat_name]][hla_ids,]))
mat <- cbind(mat, 'SILA'=ls_preprocessed$pData_rnaseq$SILA,
"n_op2"=ls_preprocessed$pData_rnaseq$n_op2)
mat <- mat[-int_idx,]
x <- mat[,-which(colnames(mat) %in% c("SILA","n_op2"))]
if(scale_mat){
x <- scale(x)
}
pca_hla <- cbind(data.frame(prcomp(x)$x), 'SILA'=mat$SILA,
"n_op2"=mat$n_op2)
ggplot(pca_hla, aes(PC1, PC2, color = n_op2)) +
geom_point()
}
pca_hla(ls_preprocessed, mat_name='vsd_mat', hla_ids, scale_mat = F)
pca_hla(ls_preprocessed, mat_name='vsd_mat', hla_ids, scale_mat = T)
pca_hla(ls_preprocessed, mat_name='tpm_all', hla_ids, scale_mat = F)
pca_hla(ls_preprocessed, mat_name='tpm_all', hla_ids, scale_mat = T)
pca_hla(ls_preprocessed, mat_name='fpkm_all', hla_ids, scale_mat = F)
pca_hla(ls_preprocessed, mat_name='fpkm_all', hla_ids, scale_mat = T)
compare_hla <- function(ls_preprocessed, mat_name, hla_ids, hla_gsym, BPplot = T){
int_idx <- which(ls_preprocessed$pData_rnaseq$n_op2 == 'int')
mat <- data.frame(t(ls_preprocessed[[mat_name]][hla_ids,]))
mat <- cbind(mat, 'SILA'=ls_preprocessed$pData_rnaseq$SILA,
"n_op2"=ls_preprocessed$pData_rnaseq$n_op2)
mat <- mat[-int_idx,]
sum_df <- data.frame(matrix(nrow = 0, ncol = 4))
ind <- which(mat$n_op2 == 'ind')
for (i in colnames(mat)[grep("ENS",colnames(mat))]){
ind_med <- median(mat[ind,i])
agg_med <- median(mat[-ind,i])
pval <- wilcox.test(mat[ind,i], mat[-ind,i])
sum_df <- rbind(sum_df, c(i,ind_med, agg_med, pval$p.value))
}
colnames(sum_df) <- c('Gene', 'Median.Ind', 'Median.Agg', 'p.value')
sum_df['p.adjusted'] <- p.adjust(sum_df$p.value, method = "BH")
sum_df <- cbind('Symbol'=hla_gsym, sum_df)
sum_df <- sum_df %>%
arrange(p.value) %>%
slice(which(p.value < 0.09))
#print(sum_df)
# boxplots
if(BPplot){
x <- mat[,sum_df$Gene]
colnames(x) <- sum_df$Symbol
x['n_op2'] <- mat$n_op2
x <- reshape2::melt(x)
lb <- x$n_op2
lb[which(x[,'n_op2'] == 'agg')] <- 'Aggressive'
lb[-which(x[,'n_op2'] == 'agg')] <- 'Indolent'
levels = c('Indolent', 'Aggressive')
x['n_op2'] <- factor(lb, levels = levels)
comp =  list(c("Indolent", "Aggressive"))
colr = c("#3498DB", "#EC7063")
if(nrow(sum_df)>1){
ggplot(x, aes(x=n_op2, y=value, color = n_op2)) +
geom_boxplot() +
ggsignif::geom_signif(comparisons = comp,
map_signif_level=TRUE) +
facet_wrap(~variable, scales='free') +
theme(plot.title = element_text(hjust = 0.5, size=22))+
scale_color_manual(values=colr, name = "Behavior")
}else{
#ggplot(x, aes(x=n_op2, y=value, color = n_op2)) +
}
}
knitr::kable(sum_df)
}
compare_hla(ls_preprocessed, mat_name='vsd_mat', hla_ids, hla_gsym,  BPplot = T)
compare_hla(ls_preprocessed, mat_name='vsd_mat', rownames(de_hla), de_hla$gene, BPplot = FALSE)
compare_hla(ls_preprocessed, mat_name='tpm_all', hla_ids, hla_gsym, BPplot = T)
compare_hla(ls_preprocessed, mat_name='tpm_all', rownames(de_hla), de_hla$gene, BPplot = FALSE)
compare_hla(ls_preprocessed, mat_name='fpkm_all', hla_ids, hla_gsym, BPplot = T)
compare_hla(ls_preprocessed, mat_name='fpkm_all', rownames(de_hla), de_hla$gene,  BPplot = FALSE)
library(viper)
dorothea2viper_regulons <- function(df) {
regulon_list <- split(df, df$tf)
viper_regulons <- lapply(regulon_list, function(regulon) {
tfmode <- stats::setNames(regulon$mor, regulon$target)
list(tfmode = tfmode, likelihood = rep(1, length(tfmode)))
})
return(viper_regulons)
}
result <- WGCNA::collapseRows(ls_preprocessed$vsd_mat,
rowGroup=ls_preprocessed$rna_all$Feature_gene_name,
rowID=rownames(ls_preprocessed$vsd_mat),
method="MaxMean")
data <- data.frame(result$datETcollapsed)
regulons = dorothea::dorothea_hs %>%
filter(confidence %in% c("A", "B"))
regu <- dorothea2viper_regulons(regulons)
vpres_25 <- t(viper(data, regu, verbose = FALSE, minsize = 25))
rownames(vpres_25) <- ls_preprocessed$p_all$pt_ID
vpres_4 <- t(viper(data, regu, verbose = FALSE, minsize = 4))
rownames(vpres_4) <- ls_preprocessed$p_all$pt_ID
ind_i <- which(ls_preprocessed$pData_rnaseq$n_op2 == 'ind')
agg_i <- which(ls_preprocessed$pData_rnaseq$n_op2 == 'agg')
mat_ind <- as.matrix(data[,ind_i])
mat_agg <- as.matrix(data[,agg_i])
# Generating NULL model
dnull <- ttestNull(mat_agg, mat_ind, per=1000)
# Generating signature
signature <- rowTtest(mat_agg, mat_ind)
signature <- (qnorm(signature$p.value/2, lower.tail = FALSE) * sign(signature$statistic))[, 1]
# Running msVIPER
mrs <- msviper(signature, regu, dnull, verbose = FALSE)
knitr::kable(summary(mrs))
plot(mrs, cex = .7)
mrs <- ledge(mrs)
knitr::kable(summary(mrs))
mcp_dcv <- data.frame(t(read.delim("~/Documents/Massion_lab/RNASeq_summary/deconvolution/output/rna_only/MCP/mcp_fpkm_dcv.txt", row.names=1)))
qts_dcv <- data.frame(t(read.delim("~/Documents/Massion_lab/RNASeq_summary/deconvolution/output/rna_only/QTS/qts_fpkm_dcv.txt", row.names=1)))
cbs_dcv <- read.delim("~/Documents/Massion_lab/RNASeq_summary/deconvolution/output/rna_only/CBS/CIBERSORT.rna_only_fpkm.txt", row.names=1)
xcell_dcv <- data.frame(t(read.delim("~/Documents/Massion_lab/RNASeq_summary/deconvolution/output/rna_only/XCELL/xCell_rnaseq_fpkm_xCell_1132060320.txt", row.names=1)))
# From Pancaldi lab signatures
main_path = '/Users/senosam/Documents/Massion_lab/RNASeq_summary/deconvolution/output/rna_only/Pancaldi'
Epidish_BPRNACan_dcv <- read.delim(file.path(main_path,"Epidish_BPRNACan_dcv.txt"),
row.names=1)
DeconRNASeq_BPRNACan_dcv <- read.delim(file.path(main_path,"DeconRNASeq_BPRNACan_dcv.txt"),
row.names=1)
Epidish_BPRNACan3DProMet_dcv <- read.delim(file.path(main_path,"Epidish_BPRNACan3DProMet_dcv.txt"),
row.names=1)
DeconRNASeq_BPRNACan3DProMet_dcv <- read.delim(file.path(main_path,"DeconRNASeq_BPRNACan3DProMet_dcv.txt"),
row.names=1)
Epidish_BPRNACanProMet_dcv <- read.delim(file.path(main_path,"Epidish_BPRNACanProMet_dcv.txt"),
row.names=1)
DeconRNASeq_BPRNACanProMet_dcv <- read.delim(file.path(main_path,"DeconRNASeq_BPRNACanProMet_dcv.txt"),
row.names=1)
frac_hm(xcell_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(xcell_dcv, pData_rnaseq, 'n_op2')
frac_hm(cbs_dcv[,1:22], pData_rnaseq, 'n_op2')
frac_boxplot(cbs_dcv[,1:22], pData_rnaseq, 'n_op2')
frac_hm(qts_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(data.frame(qts_dcv), pData_rnaseq, 'n_op2')
frac_hm(mcp_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(data.frame(mcp_dcv), pData_rnaseq, 'n_op2')
frac_hm(Epidish_BPRNACan_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(data.frame(Epidish_BPRNACan_dcv), pData_rnaseq, 'n_op2')
frac_hm(DeconRNASeq_BPRNACan_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(data.frame(DeconRNASeq_BPRNACan_dcv), pData_rnaseq, 'n_op2')
frac_hm(Epidish_BPRNACan3DProMet_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(data.frame(Epidish_BPRNACan3DProMet_dcv), pData_rnaseq, 'n_op2')
frac_hm(DeconRNASeq_BPRNACan3DProMet_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(data.frame(DeconRNASeq_BPRNACan3DProMet_dcv), pData_rnaseq, 'n_op2')
frac_hm(Epidish_BPRNACanProMet_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(data.frame(Epidish_BPRNACanProMet_dcv), pData_rnaseq, 'n_op2')
frac_hm(DeconRNASeq_BPRNACanProMet_dcv, pData_rnaseq, 'n_op2')
frac_boxplot(data.frame(DeconRNASeq_BPRNACanProMet_dcv), pData_rnaseq, 'n_op2')
View(data)
df_test <- data[1:20,1:10]
df_test
df_test_tr <- transform(df_test, ABC =R3388_YZ_1/2)
View(df_test_tr)
